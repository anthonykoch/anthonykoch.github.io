<!DOCTYPE html>
<html data-n-head="" data-n-head-ssr>
  <head>
    <meta data-n-head="true" charset="utf-8"><meta data-n-head="true" content="width=device-width,initial-scale=1" name="viewport"><meta data-n-head="true" content="Freelance front-end web developer producing high quality work with an exceptional eye for detail. Mentor. Lover of JavaScript." name="description" data-hid="description"><meta data-n-head="true" content="IE=edge" http-equiv="X-UA-Compatible"><meta data-n-head="true" content="index,follow" name="robots"><title data-n-head="true">Just Nuxt Things</title><link href="/favicon.ico" rel="icon" data-n-head="true" type="image/x-icon"><link href="https://use.typekit.net/nsr0hmh.css" rel="stylesheet" data-n-head="true"><link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css" rel="stylesheet" data-n-head="true"><script src="//assets.codepen.io/assets/embed/ei.js" async data-n-head="true"></script><link href="/_nuxt/manifest.75e149230e6e6f87b1bf.js" rel="preload" as="script"><link href="/_nuxt/vendor.4d49e051727dc94b916a.js" rel="preload" as="script"><link href="/_nuxt/app.2d1cd1f57bcad5acd756.js" rel="preload" as="script"><link href="/_nuxt/layouts/default.678975d957cfa76f41ed.js" rel="preload" as="script"><link href="/_nuxt/pages/blog/_slug.2add2899e38833fb628b.js" rel="preload" as="script"><link href="/_nuxt/app.7346b6af39ca7a5139fd01610241c529.css" rel="preload" as="style"><link href="/_nuxt/pages/index.fdfd96c8d2bb1bb249e5.js" rel="prefetch"><link href="/_nuxt/pages/about.f6274d864e61cd0ebfe4.js" rel="prefetch"><link href="/_nuxt/pages/contact.9cea9d38c2cbc24211c2.js" rel="prefetch"><link href="/_nuxt/pages/blog/index.6fdf75d1b92ef77b0742.js" rel="prefetch"><link href="/_nuxt/pages/blade.606c5b429261dec543b7.js" rel="prefetch"><link href="/_nuxt/pages/404.3942ebb26a4a0e25d988.js" rel="prefetch"><link href="/_nuxt/10.565ebbab1afd5ee46077.js" rel="prefetch"><link href="/_nuxt/app.7346b6af39ca7a5139fd01610241c529.css" rel="stylesheet">
  </head>
  <body data-n-head="">
    <div id="__nuxt" data-server-rendered="true"><div id="__layout"><div class="Page"><div><div class="Overlay is-light" style="display:none"><div><div tabindex="0"></div> <div tabindex="1"></div> <div data-lock=""><button class="Overlay-close"><svg viewBox="0 0 512 512" xmlns="http://www.w3.org/2000/svg"><path d="M278.6 256l68.2-68.2c6.2-6.2 6.2-16.4 0-22.6-6.2-6.2-16.4-6.2-22.6 0L256 233.4l-68.2-68.2c-6.2-6.2-16.4-6.2-22.6 0-3.1 3.1-4.7 7.2-4.7 11.3 0 4.1 1.6 8.2 4.7 11.3l68.2 68.2-68.2 68.2c-3.1 3.1-4.7 7.2-4.7 11.3 0 4.1 1.6 8.2 4.7 11.3 6.2 6.2 16.4 6.2 22.6 0l68.2-68.2 68.2 68.2c6.2 6.2 16.4 6.2 22.6 0 6.2-6.2 6.2-16.4 0-22.6L278.6 256z"></path></svg></button><div style="overflow:auto"><img alt="" src="data:image/gif;base64,R0lGODlhAQABAIAAAP///wAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw==" class="Image is-fullscreen" style="display:none"></div></div> <div tabindex="0"></div></div></div></div><div class="BlogToolbar"><div style="display:none"><div></div><div><button class="BlogToolbar-backToTop BlogToolbar-button" title="Back to top"><svg viewBox="0 0 205 328" xmlns="http://www.w3.org/2000/svg"><path d="M195.7 94.8c-3.1 3.1-8 3-11.3 0L110 28.4V313c0 4.4-3.6 8-8 8s-8-3.6-8-8V28.4L19.6 94.7c-3.4 2.9-8.1 3.2-11.2.1-3.1-3.1-3.3-8.5-.1-11.4 0 0 87-79.2 88-80S99.1 1 102 1s4.9 1.6 5.7 2.4 88 80 88 80c1.5 1.5 2.3 3.6 2.3 5.7s-.8 4.1-2.3 5.7z"></path></svg></button></div></div></div><div class="Sidebar"><div class="Sidebar-inner"><!----><a href="/blog/understanding-javascript-prototypes" class="SidebarButton u-mb3"><span class="SidebarButton-upper">Previous:</span><span class="SidebarButton-lower">Understanding JavaScript Prototypes</span></a><div class="Sidebar-social u-textCenter"><ul class="IconList"><li class="IconList-item"><a href="http://codepen.io/anthonykoch" class="IconList-link" title="Codepen"><svg viewBox="0 0 512 512" xmlns="http://www.w3.org/2000/svg"><path d="M241.239 303.936c-15.322-10.357-30.742-20.569-46.062-30.93-2.03-1.373-3.43-1.472-5.502-.029l-38.871 26.154C181.966 319.905 244 361.317 244 361.317v-53.786c-.012-1.224-1.553-2.78-2.761-3.595zM195.092 240.666c15.454-10.16 30.851-20.409 46.109-30.86 1.486-1.018 2.775-3.509 2.799-5.334v-51.706s-62.033 41.124-93.262 61.942c13.7 9.159 26.671 17.913 39.787 26.443 1.02.662 3.396.284 4.567-.485zM269.838 209.354a4521.517 4521.517 0 0 0 47.627 31.815c.916.604 2.92.602 3.839 0l39.751-26.467L268 152.484v53.35c.01 1.201.805 2.821 1.838 3.52zM258.109 230.369c-1.21-.802-3.611-.528-4.743.168-4.817 2.962-9.463 6.203-14.164 9.355-8.248 5.53-25.356 17.023-25.356 17.023l38.842 25.865c1.748 1.157 4.436 1.22 6.26.111l39.014-25.993c.001 0-34.079-22.701-39.853-26.529zM141 237.116v39.609l29.622-19.838z"></path><path d="M256 32C132.288 32 32 132.288 32 256s100.288 224 224 224 224-100.288 224-224S379.712 32 256 32zm139 265.006c0 5.785-2.652 9.868-7.511 13.094a38019.909 38019.909 0 0 0-123.286 82.188c-5.854 3.918-11.174 3.754-16.984-.137-40.783-27.314-81.719-54.546-122.625-81.676-5.11-3.389-7.594-7.557-7.594-13.73v-79.729c0-6.141 2.521-10.332 7.624-13.716 40.906-27.13 81.939-54.363 122.724-81.676 5.818-3.896 11.094-4.007 16.938-.095a41090.004 41090.004 0 0 0 123.261 82.195c4.678 3.106 7.453 6.943 7.453 12.66v80.622z"></path><path d="M316.247 273.234a3826.352 3826.352 0 0 1-45.386 30.332c-2.412 1.588-2.888 3.318-2.861 6.189v51.346l93.039-62.004-38.527-25.882c-2.345-1.604-3.93-1.567-6.265.019zM370 276.676V237.06l-29.59 19.873z"></path></svg></a><li class="IconList-item"><a href="https://github.com/anthonykoch" class="IconList-link" title="Github"><svg viewBox="0 0 512 512" xmlns="http://www.w3.org/2000/svg"><path d="M178.354,287.478c-9.123,0-16.928,4.207-23.201,12.833c-6.291,8.478-9.398,18.973-9.398,31.431 c0,12.474,3.166,23.008,9.398,31.509c6.273,8.54,14.039,12.771,23.201,12.771c8.494,0,15.889-4.27,22.121-12.771 c6.271-8.501,9.398-19.035,9.398-31.509c0-12.419-3.166-22.93-9.398-31.431C194.242,291.724,186.908,287.478,178.354,287.478z"></path><path d="M334.668,287.478c-9.045,0-16.891,4.207-23.182,12.833c-6.271,8.478-9.359,18.973-9.359,31.431 c0,12.474,3.186,23.008,9.359,31.509c6.291,8.54,14.098,12.771,23.182,12.771c8.533,0,15.906-4.27,22.178-12.771 c6.293-8.501,9.418-19.035,9.418-31.509c0-12.419-3.164-22.93-9.418-31.431C350.574,291.724,343.299,287.478,334.668,287.478z"></path><path d="M445.777,172h-0.059c0,0,2.793-14.264,0.314-39.18c-2.182-24.916-7.471-47.838-16.123-68.82 c0,0-4.422,0.76-12.76,2.896s-22.08,6.299-40.938,14.768c-18.541,8.54-37.986,19.788-58.297,33.505 c-13.803-3.934-34.408-5.939-61.994-5.939c-26.289,0-46.914,2.012-61.977,5.945c-44.592-30.859-81.832-47.945-112.092-51.175 c-8.594,20.982-13.883,43.991-16.045,68.97c-2.398,24.939,0.432,39.329,0.432,39.329C41.979,198.551,32,236.541,32,267.793 c0,24.244,0.658,46.078,6.125,65.48c5.564,19.31,12.662,35.13,21.098,47.221c8.611,12.121,19.012,22.788,31.576,31.938 c12.467,9.314,23.988,15.962,34.389,20.216c10.461,4.372,22.375,7.602,35.982,9.861c13.33,2.386,23.438,3.645,30.477,3.996 c0,0,28,1.494,64.354,1.494c36.354,0,64.295-1.494,64.295-1.494c7.02-0.352,17.145-1.634,30.535-3.996 c13.547-2.299,25.521-5.607,35.941-9.861c10.402-4.293,21.943-10.901,34.469-20.216c12.523-9.032,22.906-19.739,31.518-31.938 c8.436-12.091,15.494-27.911,21.098-47.221c5.486-19.402,6.145-41.385,6.145-65.629C480,237.389,469.982,199,445.777,172z M380.383,405.645C352.521,418.736,311.486,424,257.061,424l-2.143-0.039c-54.443,0-95.361-5.248-122.848-18.41 c-27.508-13.092-41.271-40.057-41.271-80.738c0-24.33,8.572-43.99,25.482-59.107c7.354-6.515,16.438-11.019,27.645-13.717 c11.129-2.558,21.354-2.762,30.969-2.465c9.398,0.415,22.551,2.196,39.344,3.464C231.029,254.285,243.535,256,256,256 c11.698,0,27.213-1.957,52.104-3.959c24.99-1.971,43.494-2.971,55.467-1c12.289,2.002,22.986,6.202,32.129,14.742 c17.734,15.751,26.602,35.505,26.602,59.084C422.301,365.533,408.164,392.537,380.383,405.645z"></path></svg></a><li class="IconList-item"><a href="https://twitter.com/anthkoch" class="IconList-link" title="Twitter"><svg viewBox="0 0 512 512" xmlns="http://www.w3.org/2000/svg"><path d="M492 109.5c-17.4 7.7-36 12.9-55.6 15.3 20-12 35.4-31 42.6-53.6-18.7 11.1-39.4 19.2-61.5 23.5C399.8 75.8 374.6 64 346.8 64c-53.5 0-96.8 43.4-96.8 96.9 0 7.6.8 15 2.5 22.1-80.5-4-151.9-42.6-199.6-101.3-8.3 14.3-13.1 31-13.1 48.7 0 33.6 17.2 63.3 43.2 80.7-16-.4-31-4.8-44-12.1v1.2c0 47 33.4 86.1 77.7 95-8.1 2.2-16.7 3.4-25.5 3.4-6.2 0-12.3-.6-18.2-1.8 12.3 38.5 48.1 66.5 90.5 67.3-33.1 26-74.9 41.5-120.3 41.5-7.8 0-15.5-.5-23.1-1.4C62.8 432 113.7 448 168.3 448 346.6 448 444 300.3 444 172.2c0-4.2-.1-8.4-.3-12.5C462.6 146 479 129 492 109.5z"></path></svg></a></ul></div></div></div><div class="Page-inner"><div><header class="SiteHeader has-blogBackground is-collapsed" data-page="TODO" role="banner"><div class="SiteHeader-container"><div class="Logo"><a href="/" class="Logo-link u-px6 is-dark is-fixed is-active"><span>Anthony </span><span>Koch</span></a></div><nav class="SiteNav" role="navigation"><ul class="SiteNav-list"><li class="SiteNav-listItem"><a href="/#work" class="SiteNav-link is-dark">
            work
          </a><li class="SiteNav-listItem"><a href="/blog" class="SiteNav-link is-dark">
            blog
          </a><li class="SiteNav-listItem"><a href="/contact" class="SiteNav-link is-dark">
            contact
          </a><li class="SiteNav-listItem has-icon"><a href="https://github.com/anthonykoch?tab=repositories" class="SiteNav-iconLink is-github is-dark" rel="noopener noreferrer" target="_blank"><svg viewBox="0 0 512 512" xmlns="http://www.w3.org/2000/svg" fill="rgba(255,255,255,0.8)"><path d="M178.354,287.478c-9.123,0-16.928,4.207-23.201,12.833c-6.291,8.478-9.398,18.973-9.398,31.431 c0,12.474,3.166,23.008,9.398,31.509c6.273,8.54,14.039,12.771,23.201,12.771c8.494,0,15.889-4.27,22.121-12.771 c6.271-8.501,9.398-19.035,9.398-31.509c0-12.419-3.166-22.93-9.398-31.431C194.242,291.724,186.908,287.478,178.354,287.478z"></path><path d="M334.668,287.478c-9.045,0-16.891,4.207-23.182,12.833c-6.271,8.478-9.359,18.973-9.359,31.431 c0,12.474,3.186,23.008,9.359,31.509c6.291,8.54,14.098,12.771,23.182,12.771c8.533,0,15.906-4.27,22.178-12.771 c6.293-8.501,9.418-19.035,9.418-31.509c0-12.419-3.164-22.93-9.418-31.431C350.574,291.724,343.299,287.478,334.668,287.478z"></path><path d="M445.777,172h-0.059c0,0,2.793-14.264,0.314-39.18c-2.182-24.916-7.471-47.838-16.123-68.82 c0,0-4.422,0.76-12.76,2.896s-22.08,6.299-40.938,14.768c-18.541,8.54-37.986,19.788-58.297,33.505 c-13.803-3.934-34.408-5.939-61.994-5.939c-26.289,0-46.914,2.012-61.977,5.945c-44.592-30.859-81.832-47.945-112.092-51.175 c-8.594,20.982-13.883,43.991-16.045,68.97c-2.398,24.939,0.432,39.329,0.432,39.329C41.979,198.551,32,236.541,32,267.793 c0,24.244,0.658,46.078,6.125,65.48c5.564,19.31,12.662,35.13,21.098,47.221c8.611,12.121,19.012,22.788,31.576,31.938 c12.467,9.314,23.988,15.962,34.389,20.216c10.461,4.372,22.375,7.602,35.982,9.861c13.33,2.386,23.438,3.645,30.477,3.996 c0,0,28,1.494,64.354,1.494c36.354,0,64.295-1.494,64.295-1.494c7.02-0.352,17.145-1.634,30.535-3.996 c13.547-2.299,25.521-5.607,35.941-9.861c10.402-4.293,21.943-10.901,34.469-20.216c12.523-9.032,22.906-19.739,31.518-31.938 c8.436-12.091,15.494-27.911,21.098-47.221c5.486-19.402,6.145-41.385,6.145-65.629C480,237.389,469.982,199,445.777,172z M380.383,405.645C352.521,418.736,311.486,424,257.061,424l-2.143-0.039c-54.443,0-95.361-5.248-122.848-18.41 c-27.508-13.092-41.271-40.057-41.271-80.738c0-24.33,8.572-43.99,25.482-59.107c7.354-6.515,16.438-11.019,27.645-13.717 c11.129-2.558,21.354-2.762,30.969-2.465c9.398,0.415,22.551,2.196,39.344,3.464C231.029,254.285,243.535,256,256,256 c11.698,0,27.213-1.957,52.104-3.959c24.99-1.971,43.494-2.971,55.467-1c12.289,2.002,22.986,6.202,32.129,14.742 c17.734,15.751,26.602,35.505,26.602,59.084C422.301,365.533,408.164,392.537,380.383,405.645z"></path></svg></a></ul></nav></div><div class="SiteHeader-lower"></div></header><div class="Page-content has-sidebar"><article class="Post" id="post"><div class="Post__container"><header class="Post-header u-gutter"><div class="u-sizeReadable u-mxauto"><h1 class="Post-title"><a href="/blog/just-nuxt-things" class="Link is-dark">
                Just Nuxt Things
              </a></h1><p class="PostMeta"><span class="PostMeta-date">
              July, 28 2018
            </span><span class="PostMeta-author">
              by Anthony Koch
            </span></div></header><div><div class="Post-body md" style="animation-delay:.3s"><p>I rewrote my website and blog using <a href="https://nuxtjs.org/">nuxt.js</a>. The experience did not come without a bit of blood, sweat, and tears, but I'm happy with the end result. This is not so much a tutorial as it is a reflection on the experience and why I did what I did.</p>
<!-- endexcerpt -->
<h3>What I wanted</h3>
<p>Originally, I wrote this blog a couple years ago with jekyll. Jekyll uses something that is or closely resembles <a href="https://shopify.github.io/liquid/">liquid templating</a>. I'm not really a fan of liquid or any templating language that obfuscates simple things into some obscure, verbose syntax (such as filters). Want to multiply two numbers together and then divide by 100?</p>
<pre><code>{{ age | times: 2 | divided_by: 100 }}
</code></pre>
<p>Imagine doing even more complex math than this. It's absolutely terrible and takes forever to read. This would simply be <code>{{ age * 2 / 100 }}</code> in any other syntax that allows rendering expressions.</p>
<p>Something with a better templating syntax was definitely in order, but I also wanted:</p>
<ol>
<li>For those who disable JavaScript by default (such as myself) to still be able to view most of the site.</li>
<li>For everything to function as a single page app for those with JavaScript enabled.</li>
<li>To be able to use Vue since it has a pretty good featured templating system.</li>
</ol>
<p>Thankfully, the good folks from <a href="https://zeit.co/">Zeit</a> have my needs covered with their open source project Nuxt. Nuxt is a framework for creating Server Side Rendered (SSR) apps with Vue, but it can also be used to generate a static site.</p>
<p>Nuxt offers pretty much everything I wanted. I could completely pre-render the website to a static site for users with JavaScript disabled while still being able to use Vue for those with it enabled. On top of everything, it also works as a single page app for users with JavaScript enabled. Wowee, sign me up!</p>
<h3>I also wanted performance</h3>
<p>The few tutorials I looked into on how to create a blog with Nuxt end up loading all posts on every single request, even pages completely unrelated to blogging. If each post is around 15KB of text, highlighted code blocks, etc., then we're talking <code>~4-6KB</code> gzipped for each post. Just 30 posts is 150K of already gzipped content being loaded on every page. For a small site with only a few posts, this might be ok, but as I write more and more in the future, this is going to add up to be quite a lot.</p>
<p>It didn't seem like there were any modules in the community to turn markdown files into JSON with various metadata. So, being a DIY oriented person, I decided I would just write all of the functionality. I just needed to simply convert the posts to json and load them with axios in the post template.</p>
<h3>Converting posts to json</h3>
<p>My solution to convert the posts to JSON was to write a webpack plugin. I won't go into detail with code examples of how it works, because there's a lot of code that goes into it. If you want to see the source files, you can find <a href="https://github.com/anthonykoch/website/blob/master">them in here</a> (look in <code>~/.webpack</code> and <code>nuxt.config.js</code>.</p>
<p>Basically, I use <a href="https://github.com/anthonykoch/website/blob/master/plugins/bootstrap.js#L11"><code>require.context</code> paired with <code>file-loader</code></a>  to <a href="https://github.com/anthonykoch/website/blob/master/nuxt.config.js#L136">load the markdown files</a>. This setup makes the files available to the <a href="https://github.com/anthonykoch/website/blob/master/.webpack/transform-file-plugin.js">webpack plugin I wrote</a> and from there allows me to <a href="https://github.com/anthonykoch/website/blob/master/nuxt.config.js#L159">transform each post</a> into a JSON file with all the necessary metadata.</p>
<p>This might not the best way to do it, but was the easiest I could think of with my limited knowledge of writing webpack loaders and plugins. One downside to this approach is the post page doesn't automatically update when making a change to the markdown file. I'm hoping to fix later on, but for now, I'll just have to use good old <code>ctrl+r</code>.</p>
<h3>A major Nuxt gotcha</h3>
<p>You can not fetch content from the same server when using <code>npm run generate</code>. For example, a request like this: <code>axios.get('/_nuxt/hello-world.json')</code> will fail when running <code>npm run generate</code> and you'll get this lovely little error message.</p>
<pre><code>  nuxt:generate Generate file: /blog/understanding-javascript-prototypes/index.html +0ms
  Error: connect ECONNREFUSED 127.0.0.1:3000

  - util.js:1003 Object._errnoException
    util.js:1003:13

  - util.js:1024 _exceptionWithHostPort
    util.js:1024:20

  - net.js:1181 TCPConnectWrap.afterConnect [as oncomplete]
    net.js:1181:14
</code></pre>
<p>This happens because the server doesn't actually run while <code>npm run generate</code> is going. I'm not sure why they decided to do that, but it is what it is.</p>
<p>That's actually all irrelevant because you have to remember that Vue is not running inside a browser when running <code>npm run generate</code>, but inside of a node process. In a browser, axios would assume the root <code>/</code> to be the same domain (which is <code>localhost:3000</code>) but in a node process, the root <code>/</code> defaults to <code>127.0.0.1:80</code>. So, we end up having another problem in that axios is sending requests to the wrong place.</p>
<h4>Solving the gotcha</h4>
<p>I solved this in a hacky way with <a href="https://github.com/anthonykoch/website/blob/master/core/fetch.js">the code below</a> and by keeping the dev server open in another terminal tab. This way, requests are sent to the dev server when running <code>npm run generate</code>.</p>
<pre class="hljs"><code><span class="hljs-comment">// ~/core/fetch.js</span>
<span class="hljs-keyword">import</span> axios <span class="hljs-keyword">from</span> <span class="hljs-string">'axios'</span>;

<span class="hljs-keyword">const</span> baseURL =
  process.server
      <span class="hljs-comment">// I set this to 'http://localhost:3000' in the nuxt config</span>
    ? process.env.app.baseUrl
    : <span class="hljs-string">'/'</span>;

<span class="hljs-keyword">const</span> request = axios.create({
  baseURL,
});

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> request;
</code></pre>
<p>This code creates an instance of axios that prefixes requests with <code>http://localhost:3000</code> so that requests go to the development server when running <code>npm run generate</code>. When running in an actual browser, the requests will be sent to the same domain. Remember that requests starting with a <code>/</code> are relative to the domain the code is running from, so this ends up covering both cases when the app is running in development <code>localhost:3000</code> and production <code>anthonykoch.com</code>.</p>
<p>With all of this in place, I was able to load a post as normal.</p>
<pre class="hljs"><code><span class="hljs-tag">&lt;<span class="hljs-name">template</span>></span>
  <span class="hljs-tag">&lt;<span class="hljs-name">h1</span>></span>{{ post.title }}<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>></span>
<span class="hljs-tag">&lt;/<span class="hljs-name">template</span>></span>

<span class="hljs-tag">&lt;<span class="hljs-name">script</span>></span><span class="javascript">
<span class="hljs-comment">// ~/pages/blog/_slug.vue</span>
<span class="hljs-keyword">import</span> axios <span class="hljs-keyword">from</span> <span class="hljs-string">'@/core/fetch'</span>;

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> {
  asyncData({ params, error }) {
    <span class="hljs-keyword">return</span> axios.get(<span class="hljs-string">`posts/<span class="hljs-subst">${params.slug}</span>.json`</span>)
      .then(<span class="hljs-function">(<span class="hljs-params">{ data: post }</span>) =></span> {
        <span class="hljs-keyword">return</span> {
          post,
        };
      })
      .catch(<span class="hljs-function"><span class="hljs-params">err</span> =></span> {
        error({ <span class="hljs-attr">statusCode</span>: <span class="hljs-number">404</span>, <span class="hljs-attr">message</span>: <span class="hljs-string">'Post not found'</span> });
      });
  },
};
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>></span>
</code></pre>
<h3>Things I don't like</h3>
<p>Besides the gotcha above, there's a few things I found annoying or didn't like about Nuxt.</p>
<h4>Not a standard Vue app</h4>
<p>The structure of the app strays from a normal Vue app. I would expect as much since we're not just dealing with Vue but with Server Side Rendering (SSR). However, the concept of <code>~/layouts</code> and automatic router configuration actually end up disallowing the use of some vue-router features, such as named routes and named slots (although it seems this <a href="https://github.com/nuxt/nuxt.js/issues/190">will likely change in the future</a>).</p>
<h4>Error page</h4>
<p>When there's an error, it will show an overlay that goes away when you fix the error. This is pretty standard for a Vue or React app. But when the app errors and the page is refreshed, it will show the page below. Once the error is fixed, the page doesn't refresh and app doesn't come back. This means you have to manually refresh it. It's kind of annoying, but not the end of the world.</p>
<figure>
  <figcaption>
    The nuxt error page
  </figcaption>
  <img alt="nuxt error page" src="/images/posts/just-nuxt-things/error-page+c.png">
</figure>
<h4>Scroll position</h4>
<p>This isn't really a Nuxt thing, but something against <code>vue-router</code>. The scroll position doesn't get remembered on page refresh. They allow customizing this, but it's not done by default. I have to wonder if they don't include this by default because the logic for it is too buggy and/or too difficult to achieve.</p>
<h3>The overall experience</h3>
<p>Working with Nuxt has been an interesting experience. It took a pretty good amount of time for me to figure out how to get this all to work properly, but I'm pretty happy with the end result and it serves all my needs perfectly.</p>
</div></div></div></article></div><!----></div></div></div></div></div><script type="text/javascript">window.__NUXT__={layout:"default",data:[{post:{excerpt:{content:'<p>I rewrote my website and blog using <a href="https://nuxtjs.org/">nuxt.js</a>. The experience did not come without a bit of blood, sweat, and tears, but I\'m happy with the end result. This is not so much a tutorial as it is a reflection on the experience and why I did what I did.</p>\n',loc:{start:0,end:288}},author:"Anthony Koch",title:"Just Nuxt Things",tags:["nuxt","vue","webpack"],id:7,created_at:"2018-07-29T00:00:00.000Z",humanized:{created_at:"July, 28 2018"},url:"/blog/just-nuxt-things",slug:"just-nuxt-things",next:null,previous:{url:"/blog/understanding-javascript-prototypes",author:"Anthony Koch",title:"Understanding JavaScript Prototypes",tags:["JavaScript","prototypes"],id:6,created_at:"2016-01-21T00:00:00.000Z"},contents:'<p>I rewrote my website and blog using <a href="https://nuxtjs.org/">nuxt.js</a>. The experience did not come without a bit of blood, sweat, and tears, but I\'m happy with the end result. This is not so much a tutorial as it is a reflection on the experience and why I did what I did.</p>\n\x3c!-- endexcerpt --\x3e\n<h3>What I wanted</h3>\n<p>Originally, I wrote this blog a couple years ago with jekyll. Jekyll uses something that is or closely resembles <a href="https://shopify.github.io/liquid/">liquid templating</a>. I\'m not really a fan of liquid or any templating language that obfuscates simple things into some obscure, verbose syntax (such as filters). Want to multiply two numbers together and then divide by 100?</p>\n<pre><code>{{ age | times: 2 | divided_by: 100 }}\n</code></pre>\n<p>Imagine doing even more complex math than this. It\'s absolutely terrible and takes forever to read. This would simply be <code>{{ age * 2 / 100 }}</code> in any other syntax that allows rendering expressions.</p>\n<p>Something with a better templating syntax was definitely in order, but I also wanted:</p>\n<ol>\n<li>For those who disable JavaScript by default (such as myself) to still be able to view most of the site.</li>\n<li>For everything to function as a single page app for those with JavaScript enabled.</li>\n<li>To be able to use Vue since it has a pretty good featured templating system.</li>\n</ol>\n<p>Thankfully, the good folks from <a href="https://zeit.co/">Zeit</a> have my needs covered with their open source project Nuxt. Nuxt is a framework for creating Server Side Rendered (SSR) apps with Vue, but it can also be used to generate a static site.</p>\n<p>Nuxt offers pretty much everything I wanted. I could completely pre-render the website to a static site for users with JavaScript disabled while still being able to use Vue for those with it enabled. On top of everything, it also works as a single page app for users with JavaScript enabled. Wowee, sign me up!</p>\n<h3>I also wanted performance</h3>\n<p>The few tutorials I looked into on how to create a blog with Nuxt end up loading all posts on every single request, even pages completely unrelated to blogging. If each post is around 15KB of text, highlighted code blocks, etc., then we\'re talking <code>~4-6KB</code> gzipped for each post. Just 30 posts is 150K of already gzipped content being loaded on every page. For a small site with only a few posts, this might be ok, but as I write more and more in the future, this is going to add up to be quite a lot.</p>\n<p>It didn\'t seem like there were any modules in the community to turn markdown files into JSON with various metadata. So, being a DIY oriented person, I decided I would just write all of the functionality. I just needed to simply convert the posts to json and load them with axios in the post template.</p>\n<h3>Converting posts to json</h3>\n<p>My solution to convert the posts to JSON was to write a webpack plugin. I won\'t go into detail with code examples of how it works, because there\'s a lot of code that goes into it. If you want to see the source files, you can find <a href="https://github.com/anthonykoch/website/blob/master">them in here</a> (look in <code>~/.webpack</code> and <code>nuxt.config.js</code>.</p>\n<p>Basically, I use <a href="https://github.com/anthonykoch/website/blob/master/plugins/bootstrap.js#L11"><code>require.context</code> paired with <code>file-loader</code></a>  to <a href="https://github.com/anthonykoch/website/blob/master/nuxt.config.js#L136">load the markdown files</a>. This setup makes the files available to the <a href="https://github.com/anthonykoch/website/blob/master/.webpack/transform-file-plugin.js">webpack plugin I wrote</a> and from there allows me to <a href="https://github.com/anthonykoch/website/blob/master/nuxt.config.js#L159">transform each post</a> into a JSON file with all the necessary metadata.</p>\n<p>This might not the best way to do it, but was the easiest I could think of with my limited knowledge of writing webpack loaders and plugins. One downside to this approach is the post page doesn\'t automatically update when making a change to the markdown file. I\'m hoping to fix later on, but for now, I\'ll just have to use good old <code>ctrl+r</code>.</p>\n<h3>A major Nuxt gotcha</h3>\n<p>You can not fetch content from the same server when using <code>npm run generate</code>. For example, a request like this: <code>axios.get(\'/_nuxt/hello-world.json\')</code> will fail when running <code>npm run generate</code> and you\'ll get this lovely little error message.</p>\n<pre><code>  nuxt:generate Generate file: /blog/understanding-javascript-prototypes/index.html +0ms\n  Error: connect ECONNREFUSED 127.0.0.1:3000\n\n  - util.js:1003 Object._errnoException\n    util.js:1003:13\n\n  - util.js:1024 _exceptionWithHostPort\n    util.js:1024:20\n\n  - net.js:1181 TCPConnectWrap.afterConnect [as oncomplete]\n    net.js:1181:14\n</code></pre>\n<p>This happens because the server doesn\'t actually run while <code>npm run generate</code> is going. I\'m not sure why they decided to do that, but it is what it is.</p>\n<p>That\'s actually all irrelevant because you have to remember that Vue is not running inside a browser when running <code>npm run generate</code>, but inside of a node process. In a browser, axios would assume the root <code>/</code> to be the same domain (which is <code>localhost:3000</code>) but in a node process, the root <code>/</code> defaults to <code>127.0.0.1:80</code>. So, we end up having another problem in that axios is sending requests to the wrong place.</p>\n<h4>Solving the gotcha</h4>\n<p>I solved this in a hacky way with <a href="https://github.com/anthonykoch/website/blob/master/core/fetch.js">the code below</a> and by keeping the dev server open in another terminal tab. This way, requests are sent to the dev server when running <code>npm run generate</code>.</p>\n<pre class="hljs"><code><span class="hljs-comment">// ~/core/fetch.js</span>\n<span class="hljs-keyword">import</span> axios <span class="hljs-keyword">from</span> <span class="hljs-string">\'axios\'</span>;\n\n<span class="hljs-keyword">const</span> baseURL =\n  process.server\n      <span class="hljs-comment">// I set this to \'http://localhost:3000\' in the nuxt config</span>\n    ? process.env.app.baseUrl\n    : <span class="hljs-string">\'/\'</span>;\n\n<span class="hljs-keyword">const</span> request = axios.create({\n  baseURL,\n});\n\n<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> request;\n</code></pre>\n<p>This code creates an instance of axios that prefixes requests with <code>http://localhost:3000</code> so that requests go to the development server when running <code>npm run generate</code>. When running in an actual browser, the requests will be sent to the same domain. Remember that requests starting with a <code>/</code> are relative to the domain the code is running from, so this ends up covering both cases when the app is running in development <code>localhost:3000</code> and production <code>anthonykoch.com</code>.</p>\n<p>With all of this in place, I was able to load a post as normal.</p>\n<pre class="hljs"><code><span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span>\n  <span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>{{ post.title }}<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span>\n<span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span>\n\n<span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript">\n<span class="hljs-comment">// ~/pages/blog/_slug.vue</span>\n<span class="hljs-keyword">import</span> axios <span class="hljs-keyword">from</span> <span class="hljs-string">\'@/core/fetch\'</span>;\n\n<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> {\n  asyncData({ params, error }) {\n    <span class="hljs-keyword">return</span> axios.get(<span class="hljs-string">`posts/<span class="hljs-subst">${params.slug}</span>.json`</span>)\n      .then(<span class="hljs-function">(<span class="hljs-params">{ data: post }</span>) =&gt;</span> {\n        <span class="hljs-keyword">return</span> {\n          post,\n        };\n      })\n      .catch(<span class="hljs-function"><span class="hljs-params">err</span> =&gt;</span> {\n        error({ <span class="hljs-attr">statusCode</span>: <span class="hljs-number">404</span>, <span class="hljs-attr">message</span>: <span class="hljs-string">\'Post not found\'</span> });\n      });\n  },\n};\n</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>\n</code></pre>\n<h3>Things I don\'t like</h3>\n<p>Besides the gotcha above, there\'s a few things I found annoying or didn\'t like about Nuxt.</p>\n<h4>Not a standard Vue app</h4>\n<p>The structure of the app strays from a normal Vue app. I would expect as much since we\'re not just dealing with Vue but with Server Side Rendering (SSR). However, the concept of <code>~/layouts</code> and automatic router configuration actually end up disallowing the use of some vue-router features, such as named routes and named slots (although it seems this <a href="https://github.com/nuxt/nuxt.js/issues/190">will likely change in the future</a>).</p>\n<h4>Error page</h4>\n<p>When there\'s an error, it will show an overlay that goes away when you fix the error. This is pretty standard for a Vue or React app. But when the app errors and the page is refreshed, it will show the page below. Once the error is fixed, the page doesn\'t refresh and app doesn\'t come back. This means you have to manually refresh it. It\'s kind of annoying, but not the end of the world.</p>\n<figure>\n  <figcaption>\n    The nuxt error page\n  </figcaption>\n  <img src="/images/posts/just-nuxt-things/error-page+c.png" alt="nuxt error page">\n</figure>\n<h4>Scroll position</h4>\n<p>This isn\'t really a Nuxt thing, but something against <code>vue-router</code>. The scroll position doesn\'t get remembered on page refresh. They allow customizing this, but it\'s not done by default. I have to wonder if they don\'t include this by default because the logic for it is too buggy and/or too difficult to achieve.</p>\n<h3>The overall experience</h3>\n<p>Working with Nuxt has been an interesting experience. It took a pretty good amount of time for me to figure out how to get this all to work properly, but I\'m pretty happy with the end result and it serves all my needs perfectly.</p>\n'}}],error:null,state:{projects:{codepen:[{title:"vue-scuffka",video:{url:"/_nuxt/videos/howitworks2.638279d.mp4"},thumbnail:{},icon:{xlinkHref:"icon-octocat"},fade:"white",href:"http://www.anthonykoch.com/vue-scuffka",meta:{},id:"cjkaxq9bd0000fxyqt9pjyh7l"},{title:"Calculator",image:{url:"/_nuxt/img/calculator.b6306cd.png"},thumbnail:{},icon:{xlinkHref:"icon-codepen-outline"},fade:"codepen",hash:"xVQOwb",href:"http://codepen.io/anthonykoch/pen/xVQOwb",meta:{likes:193},id:"cjkaxq9bd0001fxyqnc93btbm"},{title:"Settings Page",image:{url:"/_nuxt/img/settings.40eeba4.png"},thumbnail:{},icon:{xlinkHref:"icon-codepen-outline"},fade:"codepen",hash:"QjJaQv",href:"http://codepen.io/anthonykoch/pen/QjJaQv",meta:{likes:67},id:"cjkaxq9bd0002fxyq4f7ujw20"},{title:"Medium Image Loading",image:{url:"/_nuxt/img/medium.481d2f0.png"},thumbnail:{},icon:{xlinkHref:"icon-codepen-outline"},fade:"codepen",hash:"WrOQQz",href:"http://codepen.io/anthonykoch/pen/WrOQQz",meta:{likes:77},id:"cjkaxq9bd0003fxyqdn7efz1l"},{title:"Smart Home UI",image:{url:"/_nuxt/img/smarthomeui.ed77829.png"},thumbnail:{},icon:{xlinkHref:"icon-codepen-outline"},fade:"codepen",hash:"GpQYrJ",href:"http://codepen.io/anthonykoch/pen/GpQYrJ",meta:{likes:37},id:"cjkaxq9bd0004fxyqa6anmdrp"},{title:"Social Connect",image:{url:"/_nuxt/img/social-connect.c9aeb13.png"},thumbnail:{},icon:{xlinkHref:"icon-codepen-outline"},fade:"codepen",hash:"MaQBrd",href:"http://codepen.io/anthonykoch/pen/MaQBrd",meta:{likes:46},id:"cjkaxq9bd0005fxyqd0lz8ily"}]},posts:{postsById:{},meta:[{excerpt:{content:'<p>I rewrote my website and blog using <a href="https://nuxtjs.org/">nuxt.js</a>. The experience did not come without a bit of blood, sweat, and tears, but I\'m happy with the end result. This is not so much a tutorial as it is a reflection on the experience and why I did what I did.</p>\n',loc:{start:0,end:288}},author:"Anthony Koch",title:"Just Nuxt Things",tags:["nuxt","vue","webpack"],id:7,created_at:"2018-07-29T00:00:00.000Z",humanized:{created_at:"July, 28 2018"},url:"/blog/just-nuxt-things",slug:"just-nuxt-things"},{excerpt:{content:"<p>Several months ago, I set out to get a deeper understanding of JavaScript, specifically in the area of prototypes. Prototypes were a fuzzy concept for me. I sort of knew how to use them, but didn't fully understand them. After a lot of study, I've started to see the picture of how prototypes work, and that they are not as complicated as I first thought.</p>\n",loc:{start:0,end:363}},author:"Anthony Koch",title:"Understanding JavaScript Prototypes",tags:["JavaScript","prototypes"],id:6,created_at:"2016-01-21T00:00:00.000Z",humanized:{created_at:"January, 20 2016"},url:"/blog/understanding-javascript-prototypes",slug:"understanding-javascript-prototypes"},{excerpt:{content:'<p>I was on the <a href="https://medium.com/">Medium</a> website and noticed a cool effect  they do when they lazy load their images. The image first appears blurry, and then slowly unblurs or fades out to reveal the actual image. I thought this was pretty cool, and wanted to see if I could achieve a similar effect.</p>\n',loc:{start:0,end:322}},author:"Anthony Koch",title:"Medium style image loading",tags:["stackblur","medium","lazy loading"],id:5,created_at:"2016-01-07T00:00:00.000Z",humanized:{created_at:"January, 6 2016"},url:"/blog/medium-style-images",slug:"medium-style-images"},{excerpt:{content:"<p>I had a friend ask me why you shouldn't iterate over arrays with a for-in loop, since after all, when he tried it everything worked as expected. Well, the reasoning for why you shouldn't do this is not immediately apparent, especially if you do not understand how property lookup and prototypes work.</p>\n",loc:{start:0,end:308}},author:"Anthony Koch",title:"Why you shouldn't loop arrays with for-in",tags:["JavaScript","arrays"],id:4,created_at:"2015-12-03T00:00:00.000Z",humanized:{created_at:"December, 2 2015"},url:"/blog/why-you-shouldnt-loop-arrays-with-for-in",slug:"why-you-shouldnt-loop-arrays-with-for-in"},{excerpt:{content:"<p>After an hour of research, trial, and error, I finally figured out how to get Con Emu to remember directories for tabs using Git Bash. When I first started using Con Emu, I swear it used to do this by default, but I guess updates in Con Emu or the Git Bash shell broke this feature. Either way, I've found a solution that worked for me to get this feature back.</p>\n",loc:{start:0,end:369}},author:"Anthony Koch",title:"Remember directories in Con Emu",tags:["con emu","command line"],id:3,created_at:"2015-11-15T00:00:00.000Z",humanized:{created_at:"November, 14 2015"},url:"/blog/remember-directories-in-con-emu",slug:"remember-directories-in-con-emu"},{excerpt:{content:"<p>This is an overview of some of the development tools I've found useful, as well as some opinions and experiences I have had with them.</p>\n",loc:{start:0,end:142}},author:"Anthony Koch",title:"The tools I use",tags:["development","tools"],id:2,created_at:"2015-08-21T00:00:00.000Z",humanized:{created_at:"August, 20 2015"},url:"/blog/the-tools-i-use",slug:"the-tools-i-use"},{excerpt:{content:"<p>ES2015, formerly called ES6, brings a lot of great features to JavaScript. A lot of the new features provide a much cleaner syntax for common tasks, and makes writing JavaScript so much better. After using these features for a while, I can't imagine going back to ES5. Here's an overview of my favorite features of ES2015.</p>\n",loc:{start:0,end:330}},author:"Anthony Koch",title:"My favorite features of ES2015",tags:["JavaScript","ES2015"],id:1,created_at:"2015-08-17T00:00:00.000Z",humanized:{created_at:"August, 16 2015"},url:"/blog/favorite-features-of-ES2015",slug:"favorite-features-of-ES2015"}]},navigation:{links:[{text:"work",href:"/#work",active:"/#work",scrollTo:"#work"},{text:"blog",href:"/blog",active:"/blog/"},{text:"contact",href:"/contact",active:"/contact/"}]},fullscreenImage:{isFullscreenImageShowing:!1,fullscreenImageSrc:"data:image/gif;base64,R0lGODlhAQABAIAAAP///wAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw==",fullscreenImageAlt:""}},serverRendered:!0}</script><script src="/_nuxt/manifest.75e149230e6e6f87b1bf.js" defer></script><script src="/_nuxt/layouts/default.678975d957cfa76f41ed.js" defer></script><script src="/_nuxt/pages/blog/_slug.2add2899e38833fb628b.js" defer></script><script src="/_nuxt/vendor.4d49e051727dc94b916a.js" defer></script><script src="/_nuxt/app.2d1cd1f57bcad5acd756.js" defer></script>
  

